<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>购物车</title>
    <link rel="stylesheet" href="http://i.gtimg.cn/vipstyle/frozenui/2.0.0/css/frozen.css">
    <link rel="stylesheet" href="js/search/full.css" />
    <link rel="stylesheet" type="text/css" href="css/commens.css">
    <script type="text/javascript" src="js/jquery-1.8.3.min.js" ></script>
    <script type="text/javascript" src="css/font/iconfont.js" ></script>
    <script type="text/javascript" src="js/rem.js" ></script>
    <link rel="stylesheet" type="text/css" href="./lib/dropload.css">
    <link rel="stylesheet" href="css/orderCarc.css"/>

</head>
<body>
<div class="top">
    <div class="head">
        <div class="title">购物车</div>
        <div class="left" onclick="goback()">
            <svg class="icon" aria-hidden="true">
                <use xlink:href="#icon-back-m"></use>
            </svg>
        </div>
        <div class="right">
                <span onclick="edit(this)">编辑</span>        
          </div>
    </div>
</div>
<div class="TMcon">
	<div class="carContent" style="display: none">
          <div class="null" style="display: none;">
              <img src="images/shopcars/shopcars.png" class="shopCar">
              <div class="mesdiv">
                          <text class="temesage">购物车空空如也～快去逛逛吧……^_^</text>
              </div>
              <a href="indexPage.html"><button class="goshop">去逛商城</button></a>

          </div>
	</div>
    <div class="carList">
           <div class="orderList">                 
                  <div class="orderItem" id="s1">
                      <div class="card">
                         <div class="input">
                            <label class="ui-checkbox" >
                                        <input class="carcheck" type="checkbox" >
                            </label>                         
                          </div>
                          <div class="cardLeft">
                              <img src="images/shopping/cs1.png" class="shopimg">
                          </div>
                          <div class="cardright">
                              <div class="cardTitle">娜扎同款！抖音王洪韩国dashing diva 指甲贴</div>
                              <div class="guige"><span>规格：</span><span>一套</span></div>
                              <div class="priceline">
                                  <div class="price">
                                      ￥<span class="oneprice">79.00</span> 
                                  </div>
                                  <div class="butright" style="clear: both;"> 
                                        <ul class="btn-numbox">
                                           <li>
                                                  <ul class="count">
                                                      <li><span id="num-jian" value="2" class="num-jian">-</span></li>
                                                      <li><input type="text" class="input-num" id="input-num" value="1" /></li>
                                                      <li><span id="num-jia" class="num-jia">+</span></li>
                                                  </ul>
                                              </li>
                                     </ul>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
                  <div class="orderItem" id="s1">
                      <div class="card">
                         <div class="input">
                            <label class="ui-checkbox" >
                                        <input class="carcheck" type="checkbox" >
                            </label>                         
                          </div>
                          <div class="cardLeft">
                              <img src="images/shopping/cs1.png" class="shopimg">
                          </div>
                          <div class="cardright">
                              <div class="cardTitle">娜扎同款！抖音王洪韩国dashing diva 指甲贴</div>
                              <div class="guige"><span>规格：</span><span>一套</span></div>
                              <div class="priceline">
                                  <div class="price">
                                      ￥<span class="oneprice">79.00</span> 
                                  </div>
                                  <div class="butright" style="clear: both;"> 
                                        <ul class="btn-numbox">
                                           <li>
                                                  <ul class="count">
                                                      <li><span id="num-jian" class="num-jian">-</span></li>
                                                      <li><input type="text" class="input-num" id="input-num" value="1" /></li>
                                                      <li><span id="num-jia" class="num-jia">+</span></li>
                                                  </ul>
                                              </li>
                                     </ul>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
                 <div class="orderItem" id="s1">
                      <div class="card">
                         <div class="input">
                            <label class="ui-checkbox" >
                                        <input class="carcheck" type="checkbox" >
                            </label>                         
                          </div>
                          <div class="cardLeft">
                              <img src="images/shopping/cs1.png" class="shopimg">
                          </div>
                          <div class="cardright">
                              <div class="cardTitle">娜扎同款！抖音王洪韩国dashing diva 指甲贴</div>
                              <div class="guige"><span>规格：</span><span>一套</span></div>
                              <div class="priceline">
                                  <div class="price">
                                      ￥<span class="oneprice">79.00</span> 
                                  </div>
                                  <div class="butright" style="clear: both;"> 
                                        <ul class="btn-numbox">
                                           <li>
                                                  <ul class="count">
                                                      <li><span id="num-jian" class="num-jian">-</span></li>
                                                      <li><input type="text" class="input-num" id="input-num" value="1" /></li>
                                                      <li><span id="num-jia" class="num-jia">+</span></li>
                                                  </ul>
                                              </li>
                                     </ul>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
                  <div class="orderItem">
                      <div class="card">
                         <div class="input">
                             <label class="ui-checkbox" >
                                        <input class="carcheck" type="checkbox" >
                            </label>                         
                          </div>
                          <div class="cardLeft">
                              <img src="images/shopping/cs1.png" class="shopimg">
                          </div>
                          <div class="cardright">
                              <div class="cardTitle">娜扎同款！抖音王洪韩国dashing diva 指甲贴</div>
                              <div class="priceline">
                                  <div class="price">
                                      ￥<span class="oneprice">79.00</span> 
                                  </div>
                                  <div class="butright" style="clear: both;"> 
                                        <ul class="btn-numbox">
                                            <li>
                                                  <ul class="count">
                                                      <li><span id="num-jian" class="num-jian">-</span></li>
                                                      <li><input type="text" class="input-num" id="input-num" value="1" /></li>
                                                      <li><span id="num-jia" class="num-jia">+</span></li>
                                                  </ul>
                                              </li>
　　　                                     </ul>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
          </div>
  </div>

    <div class="others">
        <div class="titleBar">
          <div class="titleName">大家还买了</div>
        </div>
        <div class="pokerBox">
            <ul class="ui-row">
                <li class="ui-col ui-col-50">
                    <div class="poker">
                        <div class="pokerImg">
                            <img src="images/index/Pic_01.png"/>
                        </div>
                        <div class="depict">
                            黄黑搭配，秀出你自己的爪子
                        </div>
                        <div class="money">
                            ￥ 6.5
                        </div>
                    </div>
                </li>
                <li class="ui-col ui-col-50">
                    <div class="poker">
                        <div class="pokerImg">
                            <img src="images/index/Pic_02.png"/>
                        </div>
                        <div class="depict">
                            2018新款全套美甲墨绿彩釉中国风蹄子
                        </div>
                        <div class="money">
                            ￥ 6.5
                        </div>
                    </div>
                </li>
                <li class="ui-col ui-col-50">
                    <div class="poker">
                        <div class="pokerImg">
                            <img src="images/index/Pic_03.png"/>
                        </div>
                        <div class="depict">
                            2018新款全套美甲墨绿彩釉中国风蹄子
                        </div>
                        <div class="money">
                            ￥ 6.5
                        </div>
                    </div>
                </li>
                <li class="ui-col ui-col-50">
                    <div class="poker">
                        <div class="pokerImg">
                            <img src="images/index/Pic_04.png"/>
                        </div>
                        <div class="depict">
                            2018新款全套美甲墨绿彩釉中国风蹄子
                        </div>
                        <div class="money">
                            ￥ 6.5
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="bottom" id="topricebt" style="display: flex">
    <div class="input">
        <label class="ui-checkbox" >
                    <input type="checkbox" class="chooseAll" >
        </label>  
        <p class="allChoose">全选</p>                  
      </div>
      <div class="check">
        <span>总价</span>
        <span class="price">¥<span id="totalprice">5000</span> </span>
      </div>
      <div class="gotopay">
        <button class="gotopay">去结算</button>
      </div>
</div>
<div class="bottom" id="remove" style="display: none;">
    <div class="input">
        <label class="ui-checkbox" >
                    <input type="checkbox" class="chooseAll" >
        </label>  
        <p class="allChoose">全选</p>                  
      </div>
    
      <div class="remove">
        <button class="remov"  id=removeButto>移出购物车</button>
      </div>
</div>
<script type="text/javascript" src="js/lib.js"></script>
<script type="text/javascript" src="./lib/dropload.js"></script>
<script type="text/javascript">

    //编辑按钮
    function edit(th){
       var chooseAll= $(".orderList").attr('data-chooseAll');
      if(th.id=="s1"){
        th.innerText="编辑"
        th.id='s2';
        document.getElementById('topricebt').style.display="flex";
        document.getElementById('remove').style.display="none";
        if(!chooseAll||chooseAll=='false'){
            $(".chooseAll").prop('checked',false);
             $(".orderList").attr('data-chooseAll',false);
        }else{
          $(".chooseAll").prop('checked','checked');
          $(".orderList").find('input[type=checkbox]').prop('checked','checked');
           $(".orderList").attr('data-chooseAll',true);

        }        

      }else{
        var chooseAll= $(".orderList").attr('data-chooseAll');
        document.getElementById('topricebt').style.display="none";
        document.getElementById('remove').style.display="flex";
        th.innerText='完成';
        th.id='s1';
        if(!chooseAll||chooseAll=='false'){
             $(".chooseAll").prop('checked',false);
             $(".orderList").attr('data-chooseAll',false);

        }else{
          $(".chooseAll").prop('checked','checked');
          $(".orderList").find('input[type=checkbox]').prop('checked','checked');
           $(".orderList").attr('data-chooseAll',true);

        }

      }
    }

    $(".goshop").click(function(){

    })
    $(function(){
     

      $('.gotopay').click(function(e){
         var xuanzelenth=$(".carcheck:checked").length;
        if(xuanzelenth==0){
            showPromise('亲,请选择商品');
        }else{
           location.href=""
        }
       
      })
    })

var _drop='';
$(function(){//分页
    // 页数
    var page = 0;
    // 每页展示5个
    var size = 5;

    // dropload
  var drop=$('.carList').dropload({
        scrollArea : window,
        loadfun:function(){
         
        },
        loadDownFn : function(me){
          console.log(me);
          console.log(11);
            page++;
            // 拼接HTML
            var result = '';
            $.ajax({
                type: 'GET',
                url: 'http://ons.me/tools/dropload/json.php?page='+page+'&size='+size,
                dataType: 'json',
                success: function(data){
                    var arrLen = data.length;
                    if(arrLen > 0){
                        for(var i=0; i<arrLen; i++){
                           
      result+='<div class="orderItem" >'+
                    '<div class="card">'+
                         '<div class="input">'+
                            '<label class="ui-checkbox" >'+
                                        '<input class="carcheck" type="checkbox" >'+
                            '</label>'+                        
                          '</div>'+
                         ' <div class="cardLeft">'+
                              '<img src="images/shopping/cs1.png" class="shopimg">'+
                          '</div>'+
                          '<div class="cardright">'+
                              '<div class="cardTitle">娜扎同款！抖音王洪韩国dashing diva 指甲贴</div>'+
                              '<div class="guige"><span>规格：</span><span>一套</span></div>'+
                              '<div class="priceline">'+
                                  '<div class="price">'+
                                      '￥<span class="oneprice">79</span>'+
                                  '</div>'+
                                  '<div class="butright" style="clear: both;">'+
                                        '<ul class="btn-numbox">'+
                                          ' <li>'+
                                                 '<ul class="count">'+
                                                      '<li><span id="num-jian" class="num-jian">-</span></li>'+
                                                      '<li><input type="text" class="input-num" id="input-num" value="1" /></li>'+
                                                      '<li><span id="num-jia" class="num-jia">+</span></li>'+
                                                  '</ul>'+
                                              '</li>'+
                                     '</ul>'+
                                  '</div>'+
                              '</div>'+
                          '</div>'+
                      '</div>'+
                    '</div>'            
                        }
                    // 如果没有数据
                    }else{
                        // 锁定
                        me.lock();
                        // 无数据
                        me.noData();
                    }
                    // 为了测试，延迟1秒加载
                    _drop=me;
                    setTimeout(function(){
                        // 插入数据到页面，放到最后面
                        $(result).appendTo('.orderList');
                        // 每次数据插入，必须重置
                        me.resetload();
                        var chooseAll= $(".orderList").attr('data-chooseAll');
                        if(chooseAll!='false'&&chooseAll){
                          $('.carcheck').prop('checked','checked');
                          getTotalFees();
                        }

                    },1000);
                },
                error: function(xhr, type){
                    alert('Ajax error!');
                    // 即使加载出错，也得重置
                    me.resetload();
                }
            });
        }
    });
});


    function getTotalFees(){
        var priceTotol=0;
            var $totolLines=$('.priceline');
             $.each($totolLines,function(key,val){
                console.log(key,val)
            var price=parseInt($(val).find('.oneprice').html());
            var num=parseInt($(val).find('.input-num').val());
            var pricet=price*num;
            priceTotol+=pricet;
            console.log(price,num,pricet);

            })
             $("#totalprice").html(priceTotol)

        
     
        return priceTotol;
        
    }
</script>
<script type="text/javascript" src="js/indexjs.js"></script>
</body>
</html>